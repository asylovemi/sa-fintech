asyncapi: 2.0.0
info:
  title: Уведомления о новых попутчиках
  version: 1.0.0
  description: Система уведомлений о новых попутчиках для маршруто
servers:
  production:
    url: wss://example.com/ws
    protocol: wss
    description: WebSocket сервер для уведомлений о попутчиках
channels:
  route.passenger.new:
    description: Канал для получения уведомлений о новых попутчиках на маршруте
    parameters:
      routeId:
        description: Идентификатор маршрута
        schema:
          type: string
          description: Уникальный идентификатор маршрута для подписки
    subscribe:
      operationId: notifyNewPassenger
      summary: Уведомление о новом попутчике на маршруте
      message:
        contentType: application/json
        payload:
          type: object
          properties:
            routeId:
              type: string
              description: Идентификатор маршрута, к которому добавляется новый попутчик
            passenger:
              type: object
              properties:
                userId:
                  type: string
                  description: Идентификатор пользователя, который стал попутчиком
                userName:
                  type: string
                  description: Имя пользователя
                userProfileUrl:
                  type: string
                  format: uri
                  description: Ссылка на профиль пользователя
                userProfilePic:
                  type: string
                  format: uri
                  description: Ссылка на фотографию профиля пользователя (если доступно)
            message:
              type: string
              description: Сообщение о новом попутчике
            timestamp:
              type: string
              format: date-time
              description: Время, когда попутчик присоединился к маршруту
            status:
              type: string
              enum:
                - added
                - error
                - pending
              description: 'Статус добавления попутчика: добавлен, ошибка или в ожидании'
          required:
            - routeId
            - passenger
            - message
